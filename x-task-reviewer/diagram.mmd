%% x-task-reviewer: Task Reviewer
%% Reviews tasks (To Review ‚Üí Done/Rework) distinguishing test/implementation
%% 3 verdicts: Accept/Minor Fixes/Needs Rework

graph TD
    Start([Start: Review Task]) --> Phase1[Phase 1: Discovery<br/>Team ID auto-discovery]

    Phase1 --> Phase2[Phase 2: Preparation<br/>Load task To Review + diffs<br/>Determine task type: test/implementation]

    Phase2 --> Phase3[Phase 3: Review Checklist]

    subgraph Checklist [Review Checks]
        C1[3.1: Universal Checks<br/>Architecture DRY KISS YAGNI<br/>Docs Security Quality<br/>No Legacy Code]
        C1 --> C2[3.2: Task Type-Specific Checks<br/>If test task: test limits 10-28<br/>Priority ‚â•15 scenarios<br/>NO performance/load tests]
    end

    Phase3 --> C1
    C2 --> Phase4

    Phase4[Phase 4: Verdict & Update]

    Phase4 --> Verdict{Verdict?}
    Verdict -->|Accept ‚úÖ| Accept[Update checkboxes<br/>Update status: To Review ‚Üí Done<br/>Update kanban_board.md<br/>Commit]
    Verdict -->|Minor Fixes üîß| MinorFixes[Apply trivial fixes<br/>Update status: To Review ‚Üí Done<br/>Update kanban_board.md<br/>Commit]
    Verdict -->|Needs Rework ‚ùå| Rework[Feedback comment<br/>Update status: To Review ‚Üí To Rework<br/>Update kanban_board.md<br/>NO commit]

    Accept --> End([End])
    MinorFixes --> End
    Rework --> End

    %% Styling
    classDef discovery fill:#E3F2FD,stroke:#1976D2,stroke-width:2px
    classDef processing fill:#FFF9C4,stroke:#F57C00,stroke-width:2px
    classDef decision fill:#FFE0B2,stroke:#E64A19,stroke-width:2px
    classDef action fill:#C8E6C9,stroke:#388E3C,stroke-width:2px
    classDef error fill:#FFCDD2,stroke:#C62828,stroke-width:2px

    class Phase1,Phase2 discovery
    class Phase3,C1,C2,Phase4 processing
    class Verdict decision
    class Accept,MinorFixes action
    class Rework error
